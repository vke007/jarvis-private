<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="apple-mobile-web-app-title" content="JARVIS"/>
<meta name="theme-color" content="#0a0014"/>
<title>JARVIS AI</title>
<link rel="manifest" href="manifest.json"/>
<style>
@import url('https://fonts.googleapis.com/css2?family=Audiowide&family=Rajdhani:wght@300;400;500;600;700&family=Orbitron:wght@400;700;900&display=swap');

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FUTURISTIC HOLOGRAPHIC THEME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --primary: #00ffaa;
  --accent: #ff00ff;
  --bg: #0a0014;
  --text: #e0e0ff;
  --glow: rgba(0,255,170,0.6);
  --glow-pink: rgba(255,0,255,0.6);
  --panel: rgba(0,255,170,0.03);
  --border: rgba(0,255,170,0.2);
  --font-main: 'Rajdhani', sans-serif;
  --font-tech: 'Audiowide', cursive;
  --font-mono: 'Orbitron', monospace;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  font-family: var(--font-main);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
}

/* Animated background */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: 
    radial-gradient(ellipse 800px 600px at 50% 0%, rgba(0,255,170,0.1), transparent),
    radial-gradient(ellipse 600px 400px at 0% 100%, rgba(255,0,255,0.08), transparent),
    radial-gradient(ellipse 500px 500px at 100% 50%, rgba(0,100,255,0.06), transparent);
  pointer-events: none;
  z-index: -1;
}

/* Holographic grid overlay */
body::after {
  content: '';
  position: fixed;
  inset: 0;
  background-image: 
    linear-gradient(rgba(0,255,170,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,255,170,0.03) 1px, transparent 1px);
  background-size: 50px 50px;
  pointer-events: none;
  z-index: 0;
  animation: gridPulse 4s ease-in-out infinite;
}

@keyframes gridPulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOGIN PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#loginPage {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
  position: relative;
  z-index: 1;
}

.login-card {
  width: 100%;
  max-width: 440px;
  background: rgba(10,0,20,0.85);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 50px 40px;
  position: relative;
  backdrop-filter: blur(20px);
  box-shadow: 0 0 60px var(--glow), inset 0 0 60px rgba(0,255,170,0.05);
  animation: cardEntry 0.8s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes cardEntry {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.login-card::before {
  content: '';
  position: absolute;
  inset: -2px;
  background: linear-gradient(45deg, var(--primary), var(--accent), var(--primary));
  border-radius: 16px;
  z-index: -1;
  opacity: 0;
  transition: opacity 0.3s;
  animation: borderRotate 3s linear infinite;
}

.login-card:hover::before {
  opacity: 1;
}

@keyframes borderRotate {
  to { filter: hue-rotate(360deg); }
}

.login-logo {
  text-align: center;
  margin-bottom: 10px;
}

.login-logo img {
  max-height: 80px;
  filter: drop-shadow(0 0 20px var(--glow));
  animation: logoFloat 3s ease-in-out infinite;
}

@keyframes logoFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.login-logo-text {
  font-family: var(--font-tech);
  font-size: 48px;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 30px var(--glow);
  letter-spacing: 4px;
  animation: logoGlow 2s ease-in-out infinite;
}

@keyframes logoGlow {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.3); }
}

.login-subtitle {
  text-align: center;
  font-size: 11px;
  color: var(--primary);
  letter-spacing: 3px;
  margin-bottom: 35px;
  font-weight: 600;
  opacity: 0.8;
}

.divider {
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--primary), transparent);
  margin: 25px 0;
  position: relative;
  overflow: hidden;
}

.divider::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, white, transparent);
  animation: shine 2s infinite;
}

@keyframes shine {
  from { transform: translateX(-100%); }
  to { transform: translateX(100%); }
}

.input-group {
  margin-bottom: 20px;
  position: relative;
}

.input-label {
  display: block;
  font-size: 11px;
  color: var(--primary);
  margin-bottom: 8px;
  letter-spacing: 2px;
  font-weight: 600;
}

.input-field {
  width: 100%;
  padding: 14px 16px;
  background: rgba(0,255,170,0.05);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  font-size: 15px;
  font-family: var(--font-main);
  outline: none;
  transition: all 0.3s;
}

.input-field:focus {
  border-color: var(--primary);
  box-shadow: 0 0 20px rgba(0,255,170,0.2), inset 0 0 10px rgba(0,255,170,0.05);
  transform: translateY(-2px);
}

.input-field::placeholder {
  color: rgba(224,224,255,0.3);
}

.error-msg {
  font-size: 13px;
  color: #ff3366;
  text-align: center;
  margin: 15px 0;
  display: none;
  padding: 10px;
  background: rgba(255,51,102,0.1);
  border: 1px solid rgba(255,51,102,0.3);
  border-radius: 6px;
  animation: shake 0.4s;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-10px); }
  75% { transform: translateX(10px); }
}

.btn-primary {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, var(--primary), #00cc88);
  border: none;
  border-radius: 8px;
  color: #0a0014;
  font-family: var(--font-tech);
  font-size: 15px;
  font-weight: 700;
  letter-spacing: 3px;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.btn-primary::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, transparent, rgba(255,255,255,0.3), transparent);
  transform: translateX(-100%);
  transition: transform 0.6s;
}

.btn-primary:hover::before {
  transform: translateX(100%);
}

.btn-primary:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 40px var(--glow);
}

.btn-primary:active {
  transform: translateY(-1px);
}

.forgot-link {
  text-align: center;
  margin-top: 20px;
  font-size: 13px;
}

.forgot-link a {
  color: var(--accent);
  text-decoration: none;
  transition: all 0.3s;
}

.forgot-link a:hover {
  color: var(--primary);
  text-shadow: 0 0 10px var(--glow);
}

.privacy-note {
  text-align: center;
  margin-top: 25px;
  font-size: 11px;
  color: rgba(224,224,255,0.5);
  letter-spacing: 1px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORGOT PASSWORD PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#forgotPage {
  display: none;
}

.back-link {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--primary);
  font-size: 13px;
  cursor: pointer;
  margin-bottom: 25px;
  transition: all 0.3s;
}

.back-link:hover {
  transform: translateX(-5px);
  color: var(--accent);
}

.success-msg {
  padding: 15px;
  background: rgba(0,255,170,0.1);
  border: 1px solid var(--primary);
  border-radius: 8px;
  color: var(--primary);
  text-align: center;
  margin: 15px 0;
  display: none;
  animation: fadeIn 0.5s;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app {
  display: none;
  flex-direction: column;
  min-height: 100vh;
  position: relative;
  z-index: 1;
}

/* Header */
.header {
  height: 70px;
  background: rgba(10,0,20,0.9);
  border-bottom: 2px solid var(--border);
  backdrop-filter: blur(20px);
  padding: 0 30px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 4px 30px rgba(0,255,170,0.1);
}

.header-logo {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
}

.header-logo img {
  height: 45px;
  filter: drop-shadow(0 0 15px var(--glow));
}

.header-logo-text {
  font-family: var(--font-tech);
  font-size: 28px;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: 3px;
}

.header-right {
  display: flex;
  align-items: center;
  gap: 15px;
}

.status-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: rgba(0,255,170,0.1);
  border: 1px solid var(--border);
  border-radius: 20px;
}

.status-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--primary);
  box-shadow: 0 0 15px var(--glow);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.status-text {
  font-size: 12px;
  font-weight: 600;
  color: var(--primary);
  letter-spacing: 1px;
}

.voice-btn {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: linear-gradient(135deg, rgba(0,255,170,0.2), rgba(255,0,255,0.2));
  border: 2px solid var(--border);
  color: var(--primary);
  font-size: 22px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
  position: relative;
}

.voice-btn::before {
  content: '';
  position: absolute;
  inset: -5px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  opacity: 0;
  z-index: -1;
  transition: opacity 0.3s;
}

.voice-btn:hover::before,
.voice-btn.active::before {
  opacity: 1;
  animation: spin 2s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.voice-btn.active {
  animation: voicePulse 1s infinite;
}

@keyframes voicePulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.logout-btn {
  padding: 10px 20px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 20px;
  color: var(--text);
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.3s;
}

.logout-btn:hover {
  border-color: #ff3366;
  color: #ff3366;
  box-shadow: 0 0 15px rgba(255,51,102,0.3);
}

/* Layout */
.layout {
  display: grid;
  grid-template-columns: 240px 1fr;
  min-height: calc(100vh - 70px);
}

@media (max-width: 768px) {
  .layout {
    grid-template-columns: 1fr;
  }
}

/* Sidebar */
.sidebar {
  background: rgba(10,0,20,0.6);
  border-right: 1px solid var(--border);
  padding: 25px 15px;
  backdrop-filter: blur(10px);
}

@media (max-width: 768px) {
  .sidebar {
    display: none;
  }
}

.nav-section {
  margin-bottom: 25px;
}

.nav-title {
  font-size: 10px;
  color: var(--primary);
  letter-spacing: 2px;
  margin-bottom: 10px;
  padding: 0 12px;
  font-weight: 700;
}

.nav-item {
  padding: 12px 16px;
  margin-bottom: 4px;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 14px;
  font-weight: 600;
  color: rgba(224,224,255,0.6);
  transition: all 0.3s;
  border: 1px solid transparent;
}

.nav-item:hover {
  color: var(--text);
  background: rgba(0,255,170,0.05);
  border-color: var(--border);
}

.nav-item.active {
  color: var(--primary);
  background: rgba(0,255,170,0.1);
  border-color: var(--primary);
  box-shadow: 0 0 15px rgba(0,255,170,0.2);
}

.nav-icon {
  font-size: 18px;
}

.owner-badge {
  margin-left: auto;
  font-size: 9px;
  padding: 2px 6px;
  background: linear-gradient(135deg, var(--accent), #cc00cc);
  border-radius: 3px;
  letter-spacing: 1px;
}

/* Content Panel */
.content {
  padding: 30px;
  overflow-y: auto;
}

@media (max-width: 768px) {
  .content {
    padding: 20px 15px 100px;
  }
}

/* Module */
.module {
  display: none;
  animation: moduleEntry 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.module.active {
  display: block;
}

@keyframes moduleEntry {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.module-title {
  font-family: var(--font-tech);
  font-size: 32px;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 25px;
  display: flex;
  align-items: center;
  gap: 15px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AI CHAT MINI TAB (HOME PAGE)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.chat-container {
  display: grid;
  grid-template-columns: 1fr 380px;
  gap: 25px;
  margin-bottom: 30px;
}

@media (max-width: 1200px) {
  .chat-container {
    grid-template-columns: 1fr;
  }
}

.chat-mini {
  background: rgba(0,255,170,0.03);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 25px;
  backdrop-filter: blur(10px);
  box-shadow: 0 0 40px rgba(0,255,170,0.1);
  display: flex;
  flex-direction: column;
  max-height: 500px;
}

.chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 15px;
}

.chat-title {
  font-family: var(--font-tech);
  font-size: 18px;
  color: var(--primary);
  letter-spacing: 2px;
}

.chat-clear {
  padding: 6px 12px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 6px;
  color: var(--text);
  font-size: 11px;
  cursor: pointer;
  transition: all 0.3s;
}

.chat-clear:hover {
  border-color: #ff3366;
  color: #ff3366;
}

.chat-messages {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 15px;
  padding-right: 10px;
}

.chat-message {
  margin-bottom: 15px;
  animation: messageSlide 0.3s;
}

@keyframes messageSlide {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.chat-message.user {
  text-align: right;
}

.chat-bubble {
  display: inline-block;
  padding: 12px 16px;
  border-radius: 12px;
  max-width: 80%;
  word-wrap: break-word;
}

.chat-message.user .chat-bubble {
  background: linear-gradient(135deg, var(--primary), #00cc88);
  color: #0a0014;
  border-bottom-right-radius: 4px;
}

.chat-message.ai .chat-bubble {
  background: rgba(255,0,255,0.1);
  border: 1px solid rgba(255,0,255,0.3);
  color: var(--text);
  border-bottom-left-radius: 4px;
}

.chat-input-row {
  display: flex;
  gap: 10px;
}

.chat-input {
  flex: 1;
  padding: 12px 16px;
  background: rgba(0,0,0,0.3);
  border: 1px solid var(--border);
  border-radius: 25px;
  color: var(--text);
  font-size: 14px;
  outline: none;
}

.chat-send {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), #00cc88);
  border: none;
  color: #0a0014;
  font-size: 18px;
  cursor: pointer;
  transition: all 0.3s;
}

.chat-send:hover {
  transform: scale(1.1);
  box-shadow: 0 0 20px var(--glow);
}

/* Stats Grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.stat-card {
  background: rgba(0,255,170,0.03);
  border: 2px solid var(--border);
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  position: relative;
  overflow: hidden;
  transition: all 0.3s;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 40px rgba(0,255,170,0.2);
}

.stat-number {
  font-family: var(--font-mono);
  font-size: 42px;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

.stat-label {
  font-size: 12px;
  color: rgba(224,224,255,0.7);
  letter-spacing: 2px;
  font-weight: 600;
}

/* Card */
.card {
  background: rgba(0,255,170,0.03);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 25px;
  margin-bottom: 20px;
  backdrop-filter: blur(10px);
}

.card-title {
  font-size: 14px;
  color: var(--primary);
  letter-spacing: 2px;
  margin-bottom: 15px;
  font-weight: 700;
}

/* Voice Transcript */
#voiceTranscript {
  position: fixed;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  padding: 15px 25px;
  background: rgba(10,0,20,0.95);
  border: 2px solid var(--primary);
  border-radius: 25px;
  color: var(--primary);
  font-size: 14px;
  display: none;
  z-index: 200;
  backdrop-filter: blur(20px);
  box-shadow: 0 0 40px var(--glow);
  animation: transcriptEntry 0.3s;
  max-width: 80%;
  text-align: center;
}

@keyframes transcriptEntry {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

/* Voice Timer */
.voice-timer {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 150px;
  height: 150px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(0,255,170,0.2), transparent);
  border: 3px solid var(--primary);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 300;
  animation: timerPulse 1s infinite;
}

@keyframes timerPulse {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.1);
    opacity: 0.8;
  }
}

.timer-count {
  font-family: var(--font-mono);
  font-size: 48px;
  color: var(--primary);
  font-weight: 700;
}

/* Mobile Nav */
.mobile-nav {
  display: none;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(10,0,20,0.95);
  border-top: 2px solid var(--border);
  padding: 10px 0 20px;
  z-index: 100;
  backdrop-filter: blur(20px);
}

@media (max-width: 768px) {
  .mobile-nav {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
  }
}

.mobile-nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  padding: 8px;
  color: rgba(224,224,255,0.5);
  font-size: 11px;
  cursor: pointer;
  transition: all 0.3s;
}

.mobile-nav-item.active,
.mobile-nav-item:active {
  color: var(--primary);
}

.mobile-nav-icon {
  font-size: 22px;
}

/* Loading spinner */
.spinner {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(0,255,170,0.2);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin: 40px auto;
}

/* Utility classes */
.hidden {
  display: none !important;
}

.text-center {
  text-align: center;
}

.mb-20 {
  margin-bottom: 20px;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: rgba(0,0,0,0.3);
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--primary);
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LOGIN PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="loginPage">
  <div class="login-card">
    <div class="login-logo" id="loginLogoContainer">
      <div class="login-logo-text" id="loginLogoText">JARVIS</div>
    </div>
    <div class="login-subtitle">ARTIFICIAL INTELLIGENCE SYSTEM</div>
    
    <div class="divider"></div>
    
    <div class="input-group">
      <label class="input-label">// EMAIL ADDRESS</label>
      <input 
        type="email" 
        class="input-field" 
        id="loginEmail" 
        placeholder="sethuvigneshc@gmail.com"
        autocomplete="email"
      />
    </div>
    
    <div class="input-group">
      <label class="input-label">// PASSWORD</label>
      <input 
        type="password" 
        class="input-field" 
        id="loginPassword" 
        placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
        autocomplete="current-password"
      />
    </div>
    
    <div class="error-msg" id="loginError"></div>
    
    <button class="btn-primary" id="loginBtn">
      INITIALIZE SYSTEM
    </button>
    
    <div class="forgot-link">
      <a href="#" id="forgotLink">Forgot Password?</a>
    </div>
    
    <div class="privacy-note">
      ğŸ”’ PRIVATE SYSTEM â€” AUTHORIZED ACCESS ONLY
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FORGOT PASSWORD PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="forgotPage">
  <div class="login-card">
    <div class="back-link" id="backToLogin">
      â† Back to Login
    </div>
    
    <div class="login-logo">
      <div class="login-logo-text">RESET</div>
    </div>
    <div class="login-subtitle">PASSWORD RECOVERY</div>
    
    <div class="divider"></div>
    
    <div class="input-group">
      <label class="input-label">// OWNER EMAIL</label>
      <input 
        type="email" 
        class="input-field" 
        id="forgotEmail" 
        placeholder="sethuvigneshc@gmail.com"
      />
    </div>
    
    <div class="error-msg" id="forgotError"></div>
    <div class="success-msg" id="forgotSuccess"></div>
    
    <button class="btn-primary" id="forgotBtn">
      SEND RESET LINK
    </button>
    
    <div class="privacy-note">
      Reset link valid for 1 hour
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app">
  <!-- Header -->
  <div class="header">
    <div class="header-logo" id="headerLogo">
      <div class="header-logo-text" id="headerLogoText">JARVIS</div>
    </div>
    
    <div class="header-right">
      <div class="status-indicator">
        <div class="status-dot"></div>
        <div class="status-text" id="statusText">ONLINE</div>
      </div>
      
      <button class="voice-btn" id="voiceBtn" title="Voice Command">
        ğŸ¤
      </button>
      
      <button class="logout-btn" id="logoutBtn">
        LOGOUT
      </button>
    </div>
  </div>

  <div class="layout">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="nav-section">
        <div class="nav-title">MAIN</div>
        <div class="nav-item active" data-module="dashboard">
          <span class="nav-icon">â¬¡</span>
          DASHBOARD
        </div>
        <div class="nav-item" data-module="tasks">
          <span class="nav-icon">âœ“</span>
          TASKS
        </div>
        <div class="nav-item" data-module="calendar">
          <span class="nav-icon">ğŸ“…</span>
          CALENDAR
        </div>
        <div class="nav-item" data-module="health">
          <span class="nav-icon">â¤ï¸</span>
          HEALTH
        </div>
        <div class="nav-item" data-module="notes">
          <span class="nav-icon">ğŸ“</span>
          NOTES
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">INTELLIGENCE</div>
        <div class="nav-item" data-module="code">
          <span class="nav-icon">âŒ¨ï¸</span>
          CODE GEN
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">SYSTEM</div>
        <div class="nav-item" data-module="safety">
          <span class="nav-icon">ğŸ›¡ï¸</span>
          SAFETY
        </div>
        <div class="nav-item owner-only" data-module="theme" style="display:none">
          <span class="nav-icon">ğŸ¨</span>
          THEME
          <span class="owner-badge">OWNER</span>
        </div>
        <div class="nav-item owner-only" data-module="users" style="display:none">
          <span class="nav-icon">ğŸ‘¥</span>
          USERS
          <span class="owner-badge">OWNER</span>
        </div>
        <div class="nav-item" data-module="settings">
          <span class="nav-icon">âš™ï¸</span>
          SETTINGS
        </div>
      </div>
    </div>

    <!-- Content -->
    <div class="content">
      <!-- DASHBOARD MODULE -->
      <div class="module active" id="mod-dashboard">
        <div class="module-title">â¬¡ DASHBOARD</div>
        
        <div class="chat-container">
          <!-- AI Chat Mini Tab -->
          <div class="chat-mini">
            <div class="chat-header">
              <div class="chat-title">AI ASSISTANT</div>
              <button class="chat-clear" id="chatClear">CLEAR</button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
              <div class="chat-message ai">
                <div class="chat-bubble">
                  Hello! I'm JARVIS. How can I assist you today?
                </div>
              </div>
            </div>
            
            <div class="chat-input-row">
              <input 
                type="text" 
                class="chat-input" 
                id="chatInput" 
                placeholder="Type a command or question..."
                onkeydown="if(event.key==='Enter')sendChat()"
              />
              <button class="chat-send" id="chatSend" onclick="sendChat()">
                â¤
              </button>
            </div>
          </div>
          
          <!-- Stats -->
          <div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-number" id="statTasks">0</div>
                <div class="stat-label">PENDING TASKS</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="statEvents">0</div>
                <div class="stat-label">EVENTS</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="statNotes">0</div>
                <div class="stat-label">NOTES</div>
              </div>
              <div class="stat-card">
                <div class="stat-number" id="statSteps">0</div>
                <div class="stat-label">STEPS TODAY</div>
              </div>
            </div>
            
            <div class="card">
              <div class="card-title">QUICK ACTIONS</div>
              <div style="display:flex;flex-wrap:wrap;gap:10px">
                <button class="btn-primary" style="width:auto;padding:10px 20px;font-size:12px" onclick="goTo('tasks')">
                  + TASK
                </button>
                <button class="btn-primary" style="width:auto;padding:10px 20px;font-size:12px;opacity:0.7" onclick="goTo('calendar')">
                  + EVENT
                </button>
                <button class="btn-primary" style="width:auto;padding:10px 20px;font-size:12px;opacity:0.7" onclick="goTo('health')">
                  LOG HEALTH
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- OTHER MODULES (PLACEHOLDER) -->
      <div class="module" id="mod-tasks">
        <div class="module-title">âœ“ TASKS</div>
        <div class="card">
          <div class="card-title">TASK MANAGEMENT</div>
          <p style="color:rgba(224,224,255,0.6)">Task module coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-calendar">
        <div class="module-title">ğŸ“… CALENDAR</div>
        <div class="card">
          <div class="card-title">CALENDAR & EVENTS</div>
          <p style="color:rgba(224,224,255,0.6)">Calendar module coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-health">
        <div class="module-title">â¤ï¸ HEALTH</div>
        <div class="card">
          <div class="card-title">HEALTH TRACKING</div>
          <p style="color:rgba(224,224,255,0.6)">Health module coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-notes">
        <div class="module-title">ğŸ“ NOTES</div>
        <div class="card">
          <div class="card-title">NOTES & DOCUMENTS</div>
          <p style="color:rgba(224,224,255,0.6)">Notes module coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-code">
        <div class="module-title">âŒ¨ï¸ CODE GENERATOR</div>
        <div class="card">
          <div class="card-title">AI CODE GENERATION</div>
          <p style="color:rgba(224,224,255,0.6)">Code gen module coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-safety">
        <div class="module-title">ğŸ›¡ï¸ SAFETY</div>
        <div class="card">
          <div class="card-title">SAFETY CONTROLS</div>
          <p style="color:rgba(224,224,255,0.6)">Safety module coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-theme">
        <div class="module-title">ğŸ¨ THEME CUSTOMIZER</div>
        <div class="card">
          <div class="card-title">UPLOAD LOGO (OWNER ONLY)</div>
          <input type="file" id="logoUpload" accept="image/*" style="display:none" onchange="uploadLogo(this)"/>
          <button class="btn-primary" style="width:auto;padding:12px 24px" onclick="document.getElementById('logoUpload').click()">
            CHOOSE FILE
          </button>
          <div id="logoPreview" style="margin-top:20px"></div>
        </div>
        <div class="card" style="margin-top:20px">
          <div class="card-title">COLOR CUSTOMIZATION</div>
          <p style="color:rgba(224,224,255,0.6);margin-bottom:15px">
            Theme customization panel coming soon...
          </p>
        </div>
      </div>

      <div class="module" id="mod-users">
        <div class="module-title">ğŸ‘¥ USER MANAGEMENT</div>
        <div class="card">
          <div class="card-title">GUEST USERS (OWNER ONLY)</div>
          <p style="color:rgba(224,224,255,0.6)">User management coming soon...</p>
        </div>
      </div>

      <div class="module" id="mod-settings">
        <div class="module-title">âš™ï¸ SETTINGS</div>
        <div class="card">
          <div class="card-title">API URL</div>
          <input 
            type="text" 
            class="input-field" 
            id="apiUrl" 
            placeholder="https://your-backend.railway.app/api"
            style="margin-bottom:15px"
          />
          <button class="btn-primary" style="width:auto;padding:10px 20px;font-size:12px" onclick="saveApiUrl()">
            SAVE URL
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Nav -->
  <div class="mobile-nav">
    <div class="mobile-nav-item active" data-module="dashboard">
      <div class="mobile-nav-icon">â¬¡</div>
      HOME
    </div>
    <div class="mobile-nav-item" data-module="tasks">
      <div class="mobile-nav-icon">âœ“</div>
      TASKS
    </div>
    <div class="mobile-nav-item" data-module="code">
      <div class="mobile-nav-icon">âŒ¨ï¸</div>
      CODE
    </div>
    <div class="mobile-nav-item" data-module="safety">
      <div class="mobile-nav-icon">ğŸ›¡ï¸</div>
      SAFETY
    </div>
    <div class="mobile-nav-item" data-module="settings">
      <div class="mobile-nav-icon">âš™ï¸</div>
      MORE
    </div>
  </div>
</div>

<!-- Voice Transcript -->
<div id="voiceTranscript"></div>

<!-- Voice Timer -->
<div class="voice-timer" id="voiceTimer">
  <div class="timer-count" id="timerCount">30</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// Config
let API = localStorage.getItem('jarvis_api') || 'https://jarvis-private-production.up.railway.app/api';
let TOKEN = localStorage.getItem('jarvis_token') || '';
let ME = {};

// Voice
let recognition = null;
let voiceTimeout = null;
let voiceTimer = 30;
let voiceInterval = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('load', async () => {
  setupEventListeners();
  setupVoice();
  loadTheme();
  
  if (TOKEN) {
    const valid = await verifyToken();
    if (valid) {
      showApp();
      return;
    }
  }
  
  document.getElementById('loginPage').style.display = 'flex';
});

function setupEventListeners() {
  // Login
  document.getElementById('loginBtn').onclick = doLogin;
  document.getElementById('loginPassword').onkeydown = e => {
    if (e.key === 'Enter') doLogin();
  };
  
  // Forgot password
  document.getElementById('forgotLink').onclick = e => {
    e.preventDefault();
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('forgotPage').style.display = 'flex';
  };
  
  document.getElementById('backToLogin').onclick = () => {
    document.getElementById('forgotPage').style.display = 'none';
    document.getElementById('loginPage').style.display = 'flex';
  };
  
  document.getElementById('forgotBtn').onclick = doForgot;
  
  // App
  document.getElementById('logoutBtn').onclick = logout;
  document.getElementById('voiceBtn').onclick = toggleVoice;
  document.getElementById('chatClear').onclick = clearChat;
  
  // Navigation
  document.querySelectorAll('.nav-item[data-module]').forEach(el => {
    el.onclick = () => goTo(el.dataset.module);
  });
  
  document.querySelectorAll('.mobile-nav-item[data-module]').forEach(el => {
    el.onclick = () => goTo(el.dataset.module);
  });
  
  // Settings
  const apiInput = document.getElementById('apiUrl');
  if (apiInput) apiInput.value = API;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function doLogin() {
  const email = document.getElementById('loginEmail').value.trim();
  const pw = document.getElementById('loginPassword').value;
  const errEl = document.getElementById('loginError');
  
  errEl.style.display = 'none';
  
  try {
    const res = await fetch(`${API}/auth/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password: pw })
    });
    
    const data = await res.json();
    
    if (!res.ok) {
      errEl.textContent = data.error || 'Login failed';
      errEl.style.display = 'block';
      return;
    }
    
    TOKEN = data.token;
    ME = data;
    localStorage.setItem('jarvis_token', TOKEN);
    
    showApp();
  } catch (err) {
    errEl.textContent = 'Cannot connect to server';
    errEl.style.display = 'block';
  }
}

async function doForgot() {
  const email = document.getElementById('forgotEmail').value.trim();
  const errEl = document.getElementById('forgotError');
  const sucEl = document.getElementById('forgotSuccess');
  
  errEl.style.display = 'none';
  sucEl.style.display = 'none';
  
  try {
    const res = await fetch(`${API}/auth/forgot-password`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email })
    });
    
    const data = await res.json();
    
    if (!res.ok) {
      errEl.textContent = data.error || 'Failed';
      errEl.style.display = 'block';
      return;
    }
    
    sucEl.textContent = data.message || 'Reset link sent to your email!';
    sucEl.style.display = 'block';
  } catch (err) {
    errEl.textContent = 'Cannot connect to server';
    errEl.style.display = 'block';
  }
}

async function verifyToken() {
  try {
    const res = await apiFetch('/auth/verify');
    ME = res;
    return res.valid;
  } catch {
    return false;
  }
}

function logout() {
  TOKEN = '';
  ME = {};
  localStorage.removeItem('jarvis_token');
  document.getElementById('app').style.display = 'none';
  document.getElementById('loginPage').style.display = 'flex';
}

async function apiFetch(path, method = 'GET', body = null) {
  const opts = {
    method,
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${TOKEN}`
    }
  };
  
  if (body) opts.body = JSON.stringify(body);
  
  const res = await fetch(`${API}${path}`, opts);
  
  if (res.status === 401) {
    logout();
    throw new Error('Unauthorized');
  }
  
  return res.json();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  APP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function showApp() {
  document.getElementById('loginPage').style.display = 'none';
  document.getElementById('forgotPage').style.display = 'none';
  document.getElementById('app').style.display = 'flex';
  
  // Show owner-only items
  if (ME.is_owner) {
    document.querySelectorAll('.owner-only').forEach(el => {
      el.style.display = 'flex';
    });
  }
  
  // Load theme from server
  try {
    const theme = await apiFetch('/theme');
    applyThemeColors(theme);
    if (theme.logo_url) {
      updateLogo(theme.logo_url);
    }
    if (theme.app_name) {
      updateAppName(theme.app_name);
    }
  } catch {}
  
  // Load dashboard
  loadDashboard();
}

function goTo(module) {
  // Hide all modules
  document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
  
  // Show target
  const target = document.getElementById(`mod-${module}`);
  if (target) target.classList.add('active');
  
  // Update nav active states
  document.querySelectorAll('.nav-item, .mobile-nav-item').forEach(n => {
    n.classList.remove('active');
  });
  
  document.querySelectorAll(`[data-module="${module}"]`).forEach(n => {
    n.classList.add('active');
  });
  
  // Load module data
  if (module === 'dashboard') loadDashboard();
}

async function loadDashboard() {
  try {
    const data = await apiFetch('/dashboard');
    document.getElementById('statTasks').textContent = data.pending_tasks || 0;
    document.getElementById('statEvents').textContent = data.total_events || 0;
    document.getElementById('statNotes').textContent = data.total_notes || 0;
    document.getElementById('statSteps').textContent = data.health?.steps || 0;
  } catch {}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AI CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function sendChat() {
  const input = document.getElementById('chatInput');
  const msg = input.value.trim();
  
  if (!msg) return;
  
  // Add user message
  addChatMessage(msg, 'user');
  input.value = '';
  
  // Show typing indicator
  const typingId = addChatMessage('Thinking...', 'ai');
  
  try {
    const res = await apiFetch('/chat', 'POST', { message: msg });
    
    // Remove typing, add response
    document.getElementById(typingId)?.remove();
    addChatMessage(res.response, 'ai');
    
    // Speak if enabled
    speak(res.response);
  } catch (err) {
    document.getElementById(typingId)?.remove();
    addChatMessage(`Error: ${err.message}`, 'ai');
  }
}

function addChatMessage(text, sender) {
  const container = document.getElementById('chatMessages');
  const id = `msg-${Date.now()}`;
  
  const div = document.createElement('div');
  div.className = `chat-message ${sender}`;
  div.id = id;
  div.innerHTML = `<div class="chat-bubble">${text}</div>`;
  
  container.appendChild(div);
  container.scrollTop = container.scrollHeight;
  
  return id;
}

async function clearChat() {
  if (!confirm('Clear chat history?')) return;
  
  try {
    await apiFetch('/chat/history', 'DELETE');
    document.getElementById('chatMessages').innerHTML = `
      <div class="chat-message ai">
        <div class="chat-bubble">
          Chat cleared. How can I help you?
        </div>
      </div>
    `;
  } catch {}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VOICE (30-SECOND TIMEOUT)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setupVoice() {
  const SR = window.webkitSpeechRecognition || window.SpeechRecognition;
  if (!SR) return;
  
  recognition = new SR();
  recognition.continuous = false;
  recognition.interimResults = true;
  recognition.lang = 'en-US';
  
  recognition.onresult = e => {
    const transcript = Array.from(e.results)
      .map(r => r[0].transcript)
      .join('');
    
    showTranscript(transcript);
    
    if (e.results[e.results.length - 1].isFinal) {
      processVoiceCommand(transcript);
      stopVoice();
    }
  };
  
  recognition.onerror = e => {
    console.error('Voice error:', e.error);
    stopVoice();
  };
  
  recognition.onend = () => {
    if (document.getElementById('voiceBtn').classList.contains('active')) {
      stopVoice();
    }
  };
}

function toggleVoice() {
  const btn = document.getElementById('voiceBtn');
  
  if (btn.classList.contains('active')) {
    stopVoice();
  } else {
    startVoice();
  }
}

function startVoice() {
  const btn = document.getElementById('voiceBtn');
  const timer = document.getElementById('voiceTimer');
  
  btn.classList.add('active');
  timer.style.display = 'flex';
  
  document.getElementById('statusText').textContent = 'LISTENING';
  
  // Start recognition
  try {
    recognition?.start();
  } catch {}
  
  // Start 30-second timer
  voiceTimer = 30;
  document.getElementById('timerCount').textContent = voiceTimer;
  
  voiceInterval = setInterval(() => {
    voiceTimer--;
    document.getElementById('timerCount').textContent = voiceTimer;
    
    if (voiceTimer <= 0) {
      stopVoice();
    }
  }, 1000);
  
  // Haptic feedback
  if ('vibrate' in navigator) {
    navigator.vibrate(50);
  }
}

function stopVoice() {
  const btn = document.getElementById('voiceBtn');
  const timer = document.getElementById('voiceTimer');
  
  btn.classList.remove('active');
  timer.style.display = 'none';
  
  document.getElementById('statusText').textContent = 'ONLINE';
  
  // Stop recognition
  try {
    recognition?.stop();
  } catch {}
  
  // Clear timer
  clearInterval(voiceInterval);
  voiceTimer = 30;
  
  // Hide transcript after delay
  setTimeout(() => {
    document.getElementById('voiceTranscript').style.display = 'none';
  }, 2000);
}

function showTranscript(text) {
  const el = document.getElementById('voiceTranscript');
  el.textContent = text;
  el.style.display = 'block';
}

async function processVoiceCommand(cmd) {
  const lower = cmd.toLowerCase();
  
  // Navigation
  if (lower.includes('open') || lower.includes('show')) {
    const modules = ['tasks', 'calendar', 'health', 'notes', 'code', 'safety', 'settings'];
    for (const m of modules) {
      if (lower.includes(m)) {
        goTo(m);
        speak(`Opening ${m}`);
        return;
      }
    }
  }
  
  // News / Web search
  if (lower.includes('news') || lower.includes('latest') || lower.includes('today')) {
    document.getElementById('chatInput').value = cmd;
    sendChat();
    return;
  }
  
  // Code generation
  if (lower.includes('code') || lower.includes('write') || lower.includes('create function')) {
    document.getElementById('chatInput').value = cmd;
    sendChat();
    return;
  }
  
  // Default: Send to AI chat
  document.getElementById('chatInput').value = cmd;
  sendChat();
}

function speak(text) {
  if (!window.speechSynthesis) return;
  
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.rate = 1.0;
  utterance.pitch = 1.0;
  
  window.speechSynthesis.speak(utterance);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  THEME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadTheme() {
  const saved = localStorage.getItem('jarvis_theme');
  if (!saved) return;
  
  try {
    const theme = JSON.parse(saved);
    applyThemeColors(theme);
  } catch {}
}

function applyThemeColors(theme) {
  const root = document.documentElement.style;
  
  if (theme.primary_color) root.setProperty('--primary', theme.primary_color);
  if (theme.accent_color) root.setProperty('--accent', theme.accent_color);
  if (theme.bg_color) root.setProperty('--bg', theme.bg_color);
  if (theme.text_color) root.setProperty('--text', theme.text_color);
  
  // Save to local storage
  localStorage.setItem('jarvis_theme', JSON.stringify(theme));
}

function updateLogo(url) {
  const loginLogo = document.getElementById('loginLogoContainer');
  const headerLogo = document.getElementById('headerLogo');
  
  if (url.startsWith('data:image')) {
    loginLogo.innerHTML = `<img src="${url}" alt="Logo" style="max-height:80px;filter:drop-shadow(0 0 20px var(--glow))"/>`;
    headerLogo.innerHTML = `<img src="${url}" alt="Logo" style="height:45px;filter:drop-shadow(0 0 15px var(--glow))"/>`;
  }
}

function updateAppName(name) {
  document.querySelectorAll('.login-logo-text, .header-logo-text').forEach(el => {
    el.textContent = name;
  });
  document.title = name;
}

async function uploadLogo(input) {
  const file = input.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = async e => {
    const base64 = e.target.result;
    
    // Preview
    document.getElementById('logoPreview').innerHTML = 
      `<img src="${base64}" style="max-width:200px;border:2px solid var(--border);border-radius:8px;margin-top:15px"/>`;
    
    // Upload to server (owner only)
    try {
      await apiFetch('/logo', 'POST', { logo_base64: base64 });
      updateLogo(base64);
      alert('Logo uploaded successfully!');
    } catch (err) {
      alert('Failed to upload logo: ' + err.message);
    }
  };
  
  reader.readAsDataURL(file);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveApiUrl() {
  const url = document.getElementById('apiUrl').value.trim();
  API = url;
  localStorage.setItem('jarvis_api', API);
  alert('API URL saved! Refresh page to reconnect.');
}
</script>
</body>
</html>
